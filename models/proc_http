%let OWNER=fauserics;
%let REPO=sas;
%let PATH=models/hmeq_auto/v1;
%let PAT=ghp_xxx;  /* tu token */

filename resp temp;
proc http
  url="https://api.github.com/repos/&OWNER/&REPO/contents/&PATH"
  method="GET" out=resp;
  headers "Authorization"="token &PAT" "User-Agent"="SAS";
run;

libname R JSON fileref=resp;
proc print data=R.alldata(obs=20); run;  /* ves name, path, sha, etc. */
libname R clear;

%let URL=https://raw.githubusercontent.com/fauserics/sas/main/models/train.py;
%let OUT=%sysfunc(pathname(work))/train.py;

filename out "&OUT";
proc http url="&URL" method="GET" out=out;
run;

/*work to HOME*/
/* Ajustá el nombre si tu archivo es otro */
%let SRC=%sysfunc(pathname(work))/train.py;   /* archivo que ya tenés en WORK */
%let NAME=train.py;

/* Descubrir tu “Home” del Files Service */
%let BASE=%sysfunc(getoption(servicesbaseurl));
filename _r temp;
proc http url="&BASE/files/users/@me/home"
         method=GET out=_r oauth_bearer=sas_services;
run;
libname J json fileref=_r;
%let HOMEURI=;
data _null_;
  set J.alldata;
  if upcase(scalarkey)='URI' then call symputx('HOMEURI', value, 'L');
run;
libname J clear;

/* Subir el archivo a Files (Home) */
filename resp temp;
proc http
  method="GET"
  url="https://api.github.com/repos/fauserics/sas/contents/models/train.py?ref=main"
  out=resp;
  headers
    "User-Agent"   = "SAS"
    "Authorization"= "token &PAT"
    "Accept"       = "application/vnd.github+json"
  ;
run;


