# Reemplazá <ns> por tu namespace y <PAT> por el token (sin < >)
kubectl exec -n <ns> -it sas-model-publish-6f8dbdd879-zthcq -- sh -lc '
  echo "== Probar reachability ==";
  curl -sI https://github.com | head -n 3 || true;

  echo "== Probar Git endpoint con auth básica (debería dar 200) ==";
  PAT="<PAT>"; USER="fauserics";
  curl -s -o /dev/null -w "HTTP %{http_code}\n" \
    -u "$USER:$PAT" \
    "https://github.com/fauserics/sas.git/info/refs?service=git-upload-pack";


kubectl run curlbox -n <tu-namespace> -it --rm --restart=Never \
  --image=curlimages/curl -- sh

# ¿Resuelve DNS?
nslookup github.com || getent hosts github.com

# ¿Responde el sitio?
curl -I --connect-timeout 5 --max-time 10 https://github.com

# ¿Abre el puerto 443?
curl -sS --connect-timeout 5 --max-time 10 https://github.com > /dev/null && echo OK || echo FAIL

# Prueba del endpoint que usa git (con auth básica)
USER=fauserics
PAT='tu_token_aqui'
curl -sS -u "$USER:$PAT" --connect-timeout 5 --max-time 15 \
  "https://github.com/fauserics/sas.git/info/refs?service=git-upload-pack" | head



kubectl run curlbox -n <TU_NS> -it --rm --restart=Never --image=curlimages/curl -- sh -lc '
  USER=fauserics; PAT="TU_PAT_AQUI";
  curl -s -u "$USER:$PAT" https://api.github.com/user | sed -n "1,30p"
'
kubectl run gitbox -n <TU_NS> -it --rm --restart=Never --image=alpine/git -- sh -lc '
  USER=fauserics; PAT="TU_PAT_AQUI";
  git ls-remote https://$USER:$PAT@github.com/fauserics/sas.git | head
'


'
